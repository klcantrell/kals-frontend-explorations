webpackJsonp([6],{52:function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=function(){var a=Math.abs;const b={grid:["","","","","","","","",""],turn:"player",gameInProgress:!1,verdict:"",player_data:{shape:"X",moveHistory:[],moves:0},CPU_data:{shape:"O",moveHistory:[],moves:0},CPU_makeMove:function(){return"X"===this.player_data.shape?this.CPU_counter():this.CPU_attack()},CPU_counter:function(){switch(this.player_data.moves){case 1:return this.counter_1();case 2:case 3:case 4:return this.counter_2();}},counter_1:function(){let a=this.player_data.moveHistory;switch(a[a.length-1]){case 3:return 5;case 5:return 3;case 1:return 7;case 7:return 1;case 0:case 2:case 6:case 8:return 4;case 4:return 0;}},counter_2:function(){switch(!0){case 1<c.pursueVerticalWin().score:return this.CPU_attack();case 1<c.pursueHorizontalWin().score:return this.CPU_attack();case 1<c.pursueDiagonalWin().score:return this.CPU_attack();case"number"==typeof c.checkDiagonalThreat():return c.checkDiagonalThreat();case"number"==typeof c.checkVerticalThreat():return c.checkVerticalThreat();case"number"==typeof c.checkHorizontalThreat():return c.checkHorizontalThreat();default:return this.CPU_attack();}},counterBeforeAttack:function(){switch(!0){case 1<c.pursueVerticalWin().score:return this.attack_2();case 1<c.pursueHorizontalWin().score:return this.attack_2();case 1<c.pursueDiagonalWin().score:return this.attack_2();case"number"==typeof c.checkDiagonalThreat():return c.checkDiagonalThreat();case"number"==typeof c.checkVerticalThreat():return c.checkVerticalThreat();case"number"==typeof c.checkHorizontalThreat():return c.checkHorizontalThreat();}},CPU_attack:function(){switch(this.CPU_data.moves){case 0:return 4;case 1:case 2:case 3:case 4:return"number"==typeof this.counterBeforeAttack()?this.counterBeforeAttack():this.attack_2();}},attack_1:function(){return c.getRandomEmptySquare()},attack_2:function(){let a={vertical:c.pursueVerticalWin().score,horizontal:c.pursueHorizontalWin().score,diagonal:c.pursueDiagonalWin().score},b=Object.entries(a).sort((c,a)=>{return a[1]-c[1]})[0][0];return a.vertical===a.horizontal&&a.vertical===a.diagonal&&(b="none"),"vertical"===b?c.pursueVerticalWin().move:"horizontal"===b?c.pursueHorizontalWin().move:"diagonal"===b?c.pursueDiagonalWin().move:this.attack_1()}},c={init:function(){d.init(),g.init(),g.slideIn(),j.init(),h.init(),i.init()},startGame:function(a){d.reset(),g.slideOut(),this.toggleGameInProgress();let c=a.currentTarget.textContent;b.player_data.shape=c,b.CPU_data.shape="X"===c?"O":"X","X"===b.CPU_data.shape?(b.turn="CPU",this.processCPUMove()):this.processPlayerIdle()},processPlayerIdle:function(){c.idleTimeout=setTimeout(c.showIdleMessage,5e3)},processPlayerActive:function(){clearTimeout(c.idleTimeout)},showIdleMessage:function(){h.slideIn(),b.gameInProgress=!1},hideIdleMessage:function(){h.slideOut(),b.gameInProgress=!0},showChooseMessage:function(){i.slideIn(),b.gameInProgress=!1},hideChooseMessage:function(){i.slideOut(),b.gameInProgress=!0},toggleGameInProgress:function(){b.gameInProgress=!b.gameInProgress},processPlayerMove:function(a){if(this.processPlayerActive(),b.gameInProgress&&"player"===b.turn){let d=a.currentTarget.id;b.grid[d]?c.showChooseMessage():(this.registerPlayerMove(d),this.processCPUMove())}},registerPlayerMove:function(a){console.log(`Player chose ${a}`),b.player_data.moves++,b.player_data.moveHistory.push(parseInt(a)),b.grid[a]=b.player_data.shape,d.render(),this.checkGameOver()&&this.endGame(),b.turn="CPU"},processCPUMove:function(){setTimeout(function(){if(b.gameInProgress){let a=b.CPU_makeMove();console.log(`Computer chose ${a}`),b.CPU_data.moves++,b.CPU_data.moveHistory.push(parseInt(a)),b.grid[a]=b.CPU_data.shape,d.render(),c.checkGameOver()?c.endGame():(b.turn="player",c.processPlayerIdle())}},700)},getMoveData:function(){return"player"===b.turn?b.player_data:b.CPU_data},getGameInProgress:function(){return b.gameInProgress},getSquareData:function(a){let c=a.currentTarget.id;return b.grid[c]},getCurrentTurn:function(){return b.turn},checkGameOver:function(){let d={vertical:c.pursueVerticalWin().score,horizontal:c.pursueHorizontalWin().score,diagonal:c.pursueDiagonalWin().score},a=Object.keys(d).reduce((c,a)=>{return d[c]>d[a]?c:a}),e=!!(0>b.grid.indexOf(""));switch(!0){case 3===d[a]:return this.setVerdict(b.turn),!0;case e:return!0;default:return!1;}},endGame:function(){this.toggleGameInProgress(),j.setMessage(),j.slideIn()},setVerdict:function(a){b.verdict=a},getVerdict:function(){return b.verdict},resetGame:function(){b.grid=["","","","","","","","",""],b.verdict="",b.turn="player",b.gameInProgress=!1,b.player_data={shape:"X",moveHistory:[],moves:0},b.CPU_data={shape:"O",moveHistory:[],moves:0},d.reset(),j.slideOut(),g.slideIn()},checkVerticalThreat:function(){let c=b.player_data.moveHistory[b.player_data.moveHistory.length-1],d=b.player_data.moveHistory.map((a)=>{return a===c?void 0:c-a}),e=d.filter((b)=>{if(3===a(b)||6===a(b))return b});return"number"!=typeof e[0]||b.grid[this.nullifyVerticalThreat(c,e[0])]?!1:this.nullifyVerticalThreat(c,e[0])},nullifyVerticalThreat:function(b,c){let d=[b,b-c].sort((c,a)=>{return c-a});switch(!0){case(0===d[0]||1===d[0]||2===d[0])&&3===a(c):return d[0]+6;case(0===d[0]||1===d[0]||2===d[0])&&6===a(c):return d[0]+3;case(3===d[0]||4===d[0]||5===d[0])&&3===a(c):return d[0]-3;}},checkHorizontalThreat:function(){let a=b.player_data.moveHistory[b.player_data.moveHistory.length-1],c=b.player_data.moveHistory.filter((b)=>{if(b!==a)switch(a){case 0:case 1:case 2:return 2>=b&&0<=b;case 3:case 4:case 5:return 5>=b&&3<=b;case 6:case 7:case 8:return 8>=b&&6<=b;}}),d=!("number"!=typeof c[0])&&c.map((b)=>a-b);return"number"!=typeof d[0]||b.grid[this.nullifyHorizontalThreat(a,d[0])]?!1:this.nullifyHorizontalThreat(a,d[0])},nullifyHorizontalThreat:function(b,c){let d=[b,b-c].sort((c,a)=>{return c-a});switch(!0){case(0===d[0]||3===d[0]||6===d[0])&&1===a(c):return d[0]+2;case(0===d[0]||3===d[0]||6===d[0])&&2===a(c):return d[0]+1;case(1===d[0]||4===d[0]||7===d[0])&&1===a(c):return d[0]-1;}},checkDiagonalThreat:function(){let a=b.player_data.moveHistory[b.player_data.moveHistory.length-1],c=b.player_data.moveHistory.filter((b)=>{if(b!==a)switch(a){case 4:return 2===b||6===b;case 0:case 8:return 4===b||0===b||8===b;case 2:case 6:return 4===b||2===b||6===b;}}),d=!("number"!=typeof c[0])&&c.map((b)=>a-b);return"number"!=typeof d[0]||b.grid[this.nullifyDiagonalThreat(a,d[0])]?!1:this.nullifyDiagonalThreat(a,d)},nullifyDiagonalThreat:function(b,c){let d=[b,b-c].sort((c,a)=>{return c-a});switch(!0){case 4===d[0]&&2===a(c):return 2;case 4===d[0]&&4===a(c):return 0;case 0===d[0]&&4===a(c):return 8;case 0===d[0]&&8===a(c):return 4;case 2===d[0]&&2===a(c):return 6;case 4===d[0]&&6===a(c):return 4;}},getRandomEmptySquare:function(){let a=[];return b.grid.forEach((b,c)=>{b||a.push(c)}),a[this.randomIndexPicker(a.length)]},randomIndexPicker:function(a){return Math.floor(Math.random()*a)},pursueVerticalWin:function(){let a=this.analyzeColumns(),c=[];return a?(a.column.forEach((a)=>{b.grid[a]||c.push(a)}),1<a.score?{move:c[0],score:a.score}:{move:c[this.randomIndexPicker(c.length)],score:a.score}):{score:-99}},analyzeColumns:function(){let a={1:0,2:0,3:0},c=[0,3,6],d=[1,4,7],e=[2,5,8];c.forEach((c)=>{a[1]+=this.scoreSquare(b.grid[c])}),d.forEach((c)=>{a[2]+=this.scoreSquare(b.grid[c])}),e.forEach((c)=>{a[3]+=this.scoreSquare(b.grid[c])});let f=Object.entries(a).sort((c,a)=>{return a[1]-c[1]})[0][0];if(1<a[f])switch(f){case"1":return{column:c,score:a[f]};case"2":return{column:d,score:a[f]};case"3":return{column:e,score:a[f]};}else return!1},pursueHorizontalWin:function(){let a=this.analyzeRows(),c=[];return a?(a.row.forEach((a)=>{b.grid[a]||c.push(a)}),1<a.score?{move:c[0],score:a.score}:{move:c[this.randomIndexPicker(c.length)],score:a.score}):{score:-99}},analyzeRows:function(){let a={1:0,2:0,3:0},c=[0,1,2],d=[3,4,5],e=[6,7,8];c.forEach((c)=>{a[1]+=this.scoreSquare(b.grid[c])}),d.forEach((c)=>{a[2]+=this.scoreSquare(b.grid[c])}),e.forEach((c)=>{a[3]+=this.scoreSquare(b.grid[c])});let f=Object.entries(a).sort((c,a)=>{return a[1]-c[1]})[0][0];if(1<a[f])switch(f){case"1":return{row:c,score:a[f]};case"2":return{row:d,score:a[f]};case"3":return{row:e,score:a[f]};}else return!1},pursueDiagonalWin:function(){let a=this.analyzeDiagonals(),c=[];return a?(a.diagonal.forEach((a)=>{b.grid[a]||c.push(a)}),1<a.score?{move:c[0],score:a.score}:{move:c[this.randomIndexPicker(c.length)],score:a.score}):{score:-99}},analyzeDiagonals:function(){let a={1:0,2:0},c=[0,4,8],d=[2,4,6];c.forEach((c)=>{a[1]+=this.scoreSquare(b.grid[c])}),d.forEach((c)=>{a[2]+=this.scoreSquare(b.grid[c])});let e=Object.entries(a).sort((c,a)=>{return a[1]-c[1]})[0][0];if(1<a[e])switch(e){case"1":return{diagonal:c,score:a[e]};case"2":return{diagonal:d,score:a[e]};}else return!1},scoreSquare:function(a){let c=0;switch(a){case b.player_data.shape:c-=99;break;case b.CPU_data.shape:c++;break;default:c=0;}return c}},d={init:function(){this.cacheDome(),this.bindEvents(),this.drawBoardGrid()},cacheDome:function(){this.board=document.querySelector(".board"),this.board_grid=document.querySelector(".board-grid"),this.squares=this.board.getElementsByClassName("board__square")},bindEvents:function(){for(let a=0;a<this.squares.length;a++)this.squares[a].addEventListener("click",c.processPlayerMove.bind(c))},drawBoardGrid:function(){KUTE.fromTo("#vertical1",{draw:"0% 0%"},{draw:"0% 100%"},{duration:500,delay:200}).start(),KUTE.fromTo("#vertical2",{draw:"0% 0%"},{draw:"0% 100%"},{duration:500,delay:400}).start(),KUTE.fromTo("#horizontal1",{draw:"0% 0%"},{draw:"0% 100%"},{duration:500,delay:600}).start(),KUTE.fromTo("#horizontal2",{draw:"0% 0%"},{draw:"0% 100%"},{duration:500,delay:800}).start();for(let a=0;a<this.squares.length;a++){let b=this.squares[a],c=200*a;KUTE.to(b.firstChild,{opacity:1},{duration:1e3,delay:c}).start()}this.loadBoard()},loadBoard:function(){this.board.classList.remove("hide-before-load"),this.board_grid.style.visibility="visible"},getCurrentSquare:function(a){let b;for(let c=0,d=Object.keys(this.squares);c<d.length;c++)if(this.squares[d[c]].id==a){b=c;break}return this.squares[b]},render:function(){let a=c.getMoveData(),b=this.getCurrentSquare(a.moveHistory[a.moveHistory.length-1]);b.firstChild.innerHTML=this.insertShape(b.id,a.shape),this.drawShape(b.id,a.shape)},insertShape:function(a,b){return"X"===b?`<svg class="svg-X" style="stroke-dasharray: 110; stroke-dashoffset: 110;" width="75" height="75" viewBox="0 0 75 75">
                  <path id="diag_right${a}" d="m 0 0 75 75" stroke="hsla(9, 100%, 76%, 1)" stroke-width="2.5"/>
                  <path id="diag_left${a}" d="m 75 0 -75 75" stroke="hsla(9, 100%, 76%, 1)" stroke-width="2.5"/>
                </svg>`:`<svg class="svg-O" style="stroke-dasharray: 110; stroke-dashoffset: 110;" width="90" height="90" viewBox="3 0 21 21">
                    <path id="circle${a}" d="m 13.455845,1.0098512 c -5.4054596,0.019625 -9.7717564,4.3583082 -9.7523971,9.6907208 0.019359,5.332414 4.4170437,9.63928 9.8225031,9.619655 5.40546,-0.01962 9.771757,-4.358308 9.752397,-9.690721 -0.01936,-5.3324135 -4.417044,-9.63927948 -9.822503,-9.6196548 z" fill="transparent" stroke="hsla(42, 100%, 76%, 1)" stroke-width="0.65"/>
                 </svg>`},drawShape:function(a,b){"X"===b?(KUTE.fromTo(`#diag_right${a}`,{draw:"0% 0%"},{draw:"0% 100%"},{duration:500}).start(),KUTE.fromTo(`#diag_left${a}`,{draw:"0% 0%"},{draw:"0% 100%"},{duration:500,delay:300}).start()):KUTE.fromTo(`#circle${a}`,{draw:"0% 0%"},{draw:"0% 100%"},{duration:1500}).start()},reset:function(){for(let a=0;a<this.squares.length;a++)this.squares[a].firstChild.textContent=""}},e=(a)=>{let b,c,d=a.root;1===a.buttons?(b=d.querySelector("button"),c=()=>{b.addEventListener("click",a.handler)}):2===a.buttons&&(b=d.querySelectorAll("button"),c=()=>{for(let c=0,d=Object.keys(b);c<d.length;c++)b[d[c]].addEventListener("click",a.handler)});return{init:function(){c()},slideIn:()=>{setTimeout(()=>{d.classList.add("message--slide-in")},100)},slideOut:()=>{setTimeout(()=>{d.classList.remove("message--slide-in")},100)}}},f=(a)=>{let b=a.root.querySelector(a.messageEl);return{setMessage:()=>{let a=c.getVerdict()?`${c.getVerdict()} wins!`:"draw!";b.textContent=a}}},g=(()=>{let a={root:document.getElementById("game-start"),buttons:2,handler:c.startGame.bind(c)};return Object.assign({},e(a))})(),h=(()=>{let a={root:document.getElementById("idle-message"),buttons:1,handler:()=>{c.processPlayerActive(),c.hideIdleMessage()}};return Object.assign({},e(a))})(),i=(()=>{let a={root:document.getElementById("choose-message"),buttons:1,handler:c.hideChooseMessage};return Object.assign({},e(a))})(),j=(()=>{let a={root:document.getElementById("game-end"),buttons:1,messageEl:".message__verdict",handler:c.resetGame};return Object.assign({},e(a),f(a))})();c.init()}}});